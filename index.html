<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Space Shooter Deluxe</title>
<style>
body{
  margin:0;
  overflow:hidden;
  background:black;
  color:#0f0;
  font-family:sans-serif;
  touch-action:none;
}
canvas{
  display:block;
  width:100vw;
  height:100vh;
}
#hud,#controls,#menu,#touchControls{
  position:fixed;
  z-index:10;
}
#hud{ left:12px; top:12px; font-weight:700; color:#0ff; }
#hud div{ margin-bottom:4px; }
#controls{ right:12px; top:12px; }
#menu{
  top:0; left:0;
  width:100vw; height:100vh;
  display:flex; align-items:center;
  justify-content:center;
  background:rgba(0,0,0,0.85);
  flex-direction:column;
  color:#0ff; font-size:24px;
  text-align:center
}
button{
  margin-top:10px;
  padding:8px 14px;
  border-radius:6px;
  border:0;
  background:#222;
  color:#0ff;
  cursor:pointer
}
#touchControls{
  bottom:10px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:12px;
}
#touchControls button{
  width:70px; height:70px;
  border-radius:50%;
  font-size:24px;
  background:rgba(20,20,20,0.85);
  border:2px solid #0ff;
  color:#0ff;
}
</style>
</head>
<body>

<div id="menu">
  <div id="menuTitle">Space Shooter Deluxe</div>
  <div id="menuSubtitle">Produced & Developed by Mahd Rashid</div>
  <div id="menuExtra">Uata Marques Byron are mad buns</div>
  <button id="startBtn">Start Game</button>
</div>

<div id="hud">
  <div id="score">Score: 0</div>
  <div id="lives">Lives: 3</div>
  <div id="online">Players Online: 0</div>
</div>

<div id="controls">
  <button id="pauseBtn">Pause</button>
  <button id="resumeBtn">Resume</button>
</div>

<div id="touchControls">
  <button id="leftBtn">‚óÄ</button>
  <button id="fireBtn">‚óè</button>
  <button id="rightBtn">‚ñ∂</button>
</div>

<canvas id="game"></canvas>
<audio id="hitSound" src="https://files.catbox.moe/f7rg41.mp3"></audio>

<script>
// CANVAS SETUP
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
let W=canvas.width=innerWidth;
let H=canvas.height=innerHeight;

// GAME STATE
let paused=false;
let score=0;
let bullets=[], enemies=[], enemyBullets=[];
let flashRed=0;
let stars=[];
let particles=[];
let explosions=[];

// PLAYER
const player={
  x:W/2, y:H-80,
  w:40, h:40,
  speed:400,
  laserLevel:1,
  hits:0,
  maxHits:3,
  tilt:0
};

// INPUT
const keys={left:false,right:false};
document.addEventListener("keydown",e=>{
  if(e.key==="a"||e.key==="A") keys.left=true;
  if(e.key==="d"||e.key==="D") keys.right=true;
});
document.addEventListener("keyup",e=>{
  if(e.key==="a"||e.key==="A") keys.left=false;
  if(e.key==="d"||e.key==="D") keys.right=false;
});

// SHOOT
function shoot(){
  if(paused) return;
  for(let i=-player.laserLevel+1;i<=player.laserLevel-1;i++){
    bullets.push({
      x:player.x+i*10,
      y:player.y-20,
      r:5,
      dy:-600
    });
  }
}
canvas.addEventListener("pointerdown",shoot);

// TOUCH BUTTONS
function bind(btn, key){
  btn.addEventListener("pointerdown",e=>{e.preventDefault();keys[key]=true;});
  btn.addEventListener("pointerup",()=>keys[key]=false);
  btn.addEventListener("pointerleave",()=>keys[key]=false);
}
bind(leftBtn,"left");
bind(rightBtn,"right");
fireBtn.addEventListener("pointerdown",e=>{e.preventDefault();shoot()});

// SOUND
const hitSound=document.getElementById("hitSound");

// MENU START
startBtn.addEventListener("pointerdown",()=>{
  menu.style.display="none";
  paused=false;
  resetGame();
  hitSound.currentTime=0;
  hitSound.play();
});

// PAUSE / RESUME
pauseBtn.addEventListener("pointerdown",()=>paused=true);
resumeBtn.addEventListener("pointerdown",()=>paused=false);

// FAKE ONLINE COUNTER
let onlineCount = Math.floor(Math.random()*100)+10;
document.getElementById("online").textContent="Players Online: "+onlineCount;

setInterval(()=>{
  let diff = Math.floor(Math.random()*10)-5;
  onlineCount=Math.max(10,Math.min(150,onlineCount+diff));
  document.getElementById("online").textContent="Players Online: "+onlineCount;
},3000);

// STARFIELD BACKGROUND
for(let i=0;i<200;i++){
  stars.push({
    x:Math.random()*W,
    y:Math.random()*H,
    s:Math.random()*2+1,
    v:Math.random()*40+20
  });
}

// ENEMY SPAWN
function spawnEnemy(){
  if(paused) return;
  enemies.push({
    x:Math.random()*(W-60)+30,
    y:-40,
    w:40,h:40,
    speed:100+Math.random()*60,
    shootTimer:0.8+Math.random()*1.2
  });
}
setInterval(spawnEnemy,1200);

// EXPLOSION
function createExplosion(x,y){
  for(let i=0;i<22;i++){
    explosions.push({
      x, y,
      vx:(Math.random()*2-1)*200,
      vy:(Math.random()*2-1)*200,
      life:0.6,
      r:Math.random()*3+2
    });
  }
}

// UPDATE LOOP
function update(dt){
  if(paused) return;

  // MOVE PLAYER
  if(keys.left){ player.x-=player.speed*dt; player.tilt=-0.25; }
  else if(keys.right){ player.x+=player.speed*dt; player.tilt=0.25; }
  else player.tilt=0;

  player.x=Math.max(30,Math.min(W-30,player.x));

  // THRUSTER PARTICLES
  particles.push({
    x:player.x+(Math.random()*20-10),
    y:player.y+30,
    vy:150+Math.random()*100,
    alpha:1,
    size:2+Math.random()*2
  });

  // MOVE STARS
  stars.forEach(s=>{
    s.y+=s.v*dt;
    if(s.y>H){ s.y=0; s.x=Math.random()*W; }
  });

  // MOVE BULLETS
  bullets.forEach((b,i)=>{
    b.y+=b.dy*dt;
    if(b.y<-10) bullets.splice(i,1);
  });

  // MOVE ENEMIES
  enemies.forEach((e,i)=>{
    e.y+=e.speed*dt;

    if(e.y>H+40){ enemies.splice(i,1); return; }

    // enemy shooting
    e.shootTimer-=dt;
    if(e.shootTimer<=0){
      enemyBullets.push({
        x:e.x+20,
        y:e.y+30,
        r:6,
        dy:380
      });
      e.shootTimer=0.8+Math.random()*1.2;
    }

    // HIT BY PLAYER BULLET
    bullets.forEach((b,j)=>{
      if(b.x>e.x && b.x<e.x+e.w && b.y>e.y && b.y<e.y+e.h){
        bullets.splice(j,1);
        enemies.splice(i,1);
        score+=10;
        player.laserLevel++;
        document.getElementById("score").textContent="Score: "+score;
        createExplosion(e.x+20,e.y+20);
      }
    });
  });

  // ENEMY BULLETS
  enemyBullets.forEach((b,i)=>{
    b.y+=b.dy*dt;
    if(b.y>H){ enemyBullets.splice(i,1); return; }

    if(b.x>player.x-20 && b.x<player.x+20 &&
       b.y>player.y-20 && b.y<player.y+20){
      enemyBullets.splice(i,1);
      playerHit();
    }
  });

  // PARTICLES
  particles.forEach((p,i)=>{
    p.y+=p.vy*dt;
    p.alpha-=dt*1.5;
    if(p.alpha<=0) particles.splice(i,1);
  });

  // EXPLOSIONS
  explosions.forEach((p,i)=>{
    p.x+=p.vx*dt;
    p.y+=p.vy*dt;
    p.life-=dt;
    if(p.life<=0) explosions.splice(i,1);
  });

  if(flashRed>0) flashRed-=dt;
}

// PLAYER HIT
function playerHit(){
  player.hits++;
  flashRed=0.2;
  hitSound.currentTime=0;
  hitSound.play();

  if(player.hits>=player.maxHits){
    showGameOver();
    return;
  }

  document.getElementById("lives").textContent="Lives: "+(player.maxHits-player.hits);
}

// GAME OVER
function showGameOver(){
  paused=true;
  menuTitle.textContent="Game Over";
  menuSubtitle.textContent="Final Score: "+score;
  menuExtra.textContent="Tap to play again";
  startBtn.textContent="Play Again";
  menu.style.display="flex";
}

// DRAW LOOP
function draw(){
  ctx.clearRect(0,0,W,H);

  // FLASH RED
  if(flashRed>0){
    ctx.fillStyle=`rgba(255,0,0,${flashRed})`;
    ctx.fillRect(0,0,W,H);
  }

  // ‚≠ê STARS
  ctx.fillStyle="#ffffff";
  stars.forEach(s=>{
    ctx.globalAlpha=s.s/3;
    ctx.fillRect(s.x,s.y,s.s,s.s);
  });
  ctx.globalAlpha=1;

  // üî• PARTICLES
  particles.forEach(p=>{
    ctx.globalAlpha=p.alpha;
    ctx.fillStyle="#44ccff";
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.size,0,Math.PI*2);
    ctx.fill();
  });
  ctx.globalAlpha=1;

  // üöÄ PLAYER SPACESHIP (WITH TILT + FLAMES)
  ctx.save();
  ctx.translate(player.x,player.y);
  ctx.rotate(player.tilt);

  // engine flame
  ctx.fillStyle="rgba(0,150,255,0.8)";
  ctx.beginPath();
  ctx.moveTo(-6,28);
  ctx.lineTo(6,28);
  ctx.lineTo(0,45);
  ctx.closePath();
  ctx.fill();

  // ship body
  ctx.fillStyle="#4db8ff";
  ctx.beginPath();
  ctx.moveTo(0,-32);
  ctx.bezierCurveTo(18,-20,22,5,10,28);
  ctx.bezierCurveTo(3,40,-3,40,-10,28);
  ctx.bezierCurveTo(-22,5,-18,-20,0,-32);
  ctx.closePath();
  ctx.fill();

  // cockpit
  ctx.fillStyle="#99e6ff";
  ctx.beginPath();
  ctx.ellipse(0,-5,10,13,0,0,Math.PI*2);
  ctx.fill();

  // wings
  ctx.fillStyle="#3399ff";
  ctx.beginPath(); ctx.moveTo(-10,0); ctx.lineTo(-40,20); ctx.lineTo(-10,18); ctx.closePath(); ctx.fill();
  ctx.beginPath(); ctx.moveTo(10,0); ctx.lineTo(40,20); ctx.lineTo(10,18); ctx.closePath(); ctx.fill();

  ctx.restore();

  // üî´ PLAYER BULLETS
  ctx.fillStyle="#ffff66";
  bullets.forEach(b=>{
    ctx.beginPath();
    ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
    ctx.fill();
  });

  // üëæ ENEMIES
  enemies.forEach(e=>{
    ctx.save();
    ctx.translate(e.x+20,e.y+20);

    ctx.fillStyle="#ff3333";
    ctx.beginPath();
    ctx.moveTo(0,-20);
    ctx.lineTo(18,15);
    ctx.lineTo(-18,15);
    ctx.closePath();
    ctx.fill();

    ctx.fillStyle="#ff9999";
    ctx.beginPath();
    ctx.arc(0,-4,6,0,Math.PI*2);
    ctx.fill();

    ctx.fillStyle="#cc0000";
    ctx.fillRect(-26,6,52,6);

    ctx.restore();
  });

  // üí• EXPLOSIONS
  explosions.forEach(p=>{
    ctx.globalAlpha=p.life;
    ctx.fillStyle="#ffdd55";
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fill();
  });
  ctx.globalAlpha=1;

  // ENEMY BULLETS
  ctx.fillStyle="#ff69b4";
  enemyBullets.forEach(b=>{
    ctx.beginPath();
    ctx.arc(b.x,b.y,b.r,0,Math.PI*2);
    ctx.fill();
  });
}

// RESET GAME
function resetGame(){
  score=0;
  bullets=[];
  enemies=[];
  enemyBullets=[];
  particles=[];
  explosions=[];
  player.x=W/2;
  player.hits=0;
  player.laserLevel=1;
  document.getElementById("score").textContent="Score: 0";
  document.getElementById("lives").textContent="Lives: 3";
  flashRed=0;
}

// GAME LOOP
let last=0;
function loop(ts){
  let dt=(ts-last)/1000;
  last=ts;
  update(dt);
  draw();
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

window.addEventListener("resize",()=>{
  W=canvas.width=innerWidth;
  H=canvas.height=innerHeight;
});
</script>
</body>
</html>
